class YelpAPI{API_KEY="lNOHlGv2bXagcb0hx8e0p43SN3ApkVZSWxcCvatw-iBai9cBWij0XtCUnwXSzUcPni7SClAvrRx15FeGSUZwNGg0iQ-Z3g9jEzkDfHoyNN09LvchfqrdpaF6VMx9YHYx";API_BASE_URL="https://circuslabs.net/proxies/yelp-fusion-proxy/";constructor(){this.termInput=document.querySelector(".search-controls__input_term"),this.locationInput=document.querySelector(".search-controls__input_location"),this.priceFilter=!1,this.menuButton=document.querySelector(".search-menu__active"),this.firstMenuOpen=!0,this.sortList=document.querySelector(".search-menu__sort-list"),this.sortText=document.querySelector(".search-menu__text"),this.radiusButton=document.querySelector(".radius-menu__active"),this.radiusList=document.querySelector(".radius-menu__list"),this.radiusText=document.querySelector(".radius-menu__text"),this.firstRadiusOpen=!0,this.setupListener()}setupListener(){const e=document.querySelector(".search-controls__button"),t=document.querySelector(".price-range__toggle");e.addEventListener("click",this.handleSearch),this.locationInput.addEventListener("keyup",this.checkForEnter),this.termInput.addEventListener("keyup",this.checkForEnter),t.addEventListener("click",this.handlePriceRangeClick),this.menuButton.addEventListener("click",this.handleMenuClick),this.radiusButton.addEventListener("click",this.handleRadiusClick)}handleSearch=e=>{const t=document.querySelector(".search-controls__input_term").value;let s=document.querySelector(".search-controls__input_location").value;s||(s="Atlanta, GA");let n="best_match";-1!==this.sortText.textContent.indexOf("Rating")?n="rating":-1!==this.sortText.textContent.indexOf("Reviews")?n="review_count":-1!==this.sortText.textContent.indexOf("Distance")&&(n="distance");const i=800*parseInt(this.radiusText.textContent.substring(0,2).trim());console.log(i);const r=document.querySelector(".open-now__checkbox").checked;let a="";const c=document.querySelectorAll(".price-range__checkbox");for(let e=0;e<4;e++)c[e].checked&&(a+=`${e+1}, `);""!==a&&!1!==this.priceFilter||(a="1, 2, 3, 4, "),a=this.removeLastComma(a);const o={_ep:"/businesses/search",term:t,location:s,sort_by:n,radius:i,open_now:r,price:a},l={Authorization:`Bearer ${this.API_KEY}`};axios.get(this.API_BASE_URL,{params:o,headers:l}).then(this.processResults)};removeLastComma=e=>e.slice(0,e.length-2);processResults=e=>{const t=e.data.businesses,s=document.querySelector(".results"),n=s.querySelectorAll("*");n&&n.forEach((e=>{e.remove()})),console.log(t),t.forEach((e=>{let t=document.createElement("div");t.classList.add("results__row");let n=document.createElement("a");n.classList.add("results__photo"),n.style.background=`url(${e.image_url})`,n.style.backgroundSize="cover",n.style.backgroundPoisition="center",t.appendChild(n),n.href=e.url,n.setAttribute("target","_blank");let i=document.createElement("a");i.href=e.url,i.setAttribute("target","_blank"),i.classList.add("results__name"),i.textContent=e.name,t.appendChild(i);let r=document.createElement("div");r.classList.add("results__rating-row");let a=document.createElement("span");a.classList.add("results__rating"),a.textContent=`${e.rating} stars `,r.appendChild(a);let c=document.createElement("span");c.classList.add("results__reviews"),c.textContent=`(${e.review_count} reviews)`,r.appendChild(c),t.appendChild(r);let o=document.createElement("div");o.classList.add("results__info-row");let l=document.createElement("span");l.classList.add("results__price"),l.textContent=`${e.price} • `,o.appendChild(l);let d=document.createElement("span"),u="";if(d.classList.add("results__category"),e.categories.forEach((e=>{u+=`${e.title}, `})),u=this.removeLastComma(u),d.textContent=`${u}`,o.appendChild(d),e.transactions.length>0){let t=document.createElement("span"),s=" • ";t.classList.add("results__transactions"),e.transactions.forEach((e=>{s+=`${e}, `})),t.textContent=this.removeLastComma(s),t.style.textTransform="capitalize",o.appendChild(t)}t.appendChild(o),e.location.display_address.forEach((e=>{let s=document.createElement("p");s.classList.add("results__address-row"),s.textContent=e,t.appendChild(s)})),s.appendChild(t)}))};checkForEnter=e=>{"Enter"===e.key&&this.handleSearch()};handleMenuClick=e=>{if(this.sortList.classList.toggle("hidden"),this.firstMenuOpen){let e=document.querySelectorAll(".search-menu__item");this.firstMenuOpen=!1,e.forEach((e=>{e.addEventListener("click",this.handleMenuItemClick)}))}};handleMenuItemClick=e=>{this.sortText.textContent!=e.target.textContent&&(this.sortText.textContent=e.target.textContent,document.querySelector(".results__row")&&this.handleSearch()),this.sortList.classList.toggle("hidden")};handleRadiusClick=e=>{if(this.radiusList.classList.toggle("hidden"),this.firstRadiusOpen){let e=document.querySelectorAll(".radius-menu__item");this.firstRadiusOpen=!1,e.forEach((e=>{e.addEventListener("click",this.handleRadiusItemClick)}))}};handleRadiusItemClick=e=>{this.radiusText.textContent!=e.target.textContent&&(this.radiusText.textContent=e.target.textContent,this.locationInput.value&&this.handleSearch()),this.radiusList.classList.toggle("hidden")};handlePriceRangeClick=e=>{const t=document.querySelector(".price-range__symbol"),s=document.querySelector(".price-range__input");s.classList.contains("hidden")?(s.classList.remove("hidden"),t.textContent="< >",this.priceFilter=!0):(s.classList.add("hidden"),t.textContent="><",this.priceFilter=!1)}}
//# sourceMappingURL=yelp.js.map